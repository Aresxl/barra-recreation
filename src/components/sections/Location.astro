---
// Components
import CustomPicture from "../ui/CustomPicture.astro";

// Images
import MapImg from "@/assets/images/mobile/map.png";
---

<section class="location | grid-main">
  <div class="map__wrapper">
    <div
      class="map-facade"
      data-map-src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3152.007827770652!2d144.9680964767643!3d-37.8132856340121!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x6ad643acfb53b299%3A0xd46eb9f58e9e49c0!2sBarra!5e0!3m2!1sen!2sau!4v1768732242648!5m2!1sen!2sau"
    >
      <CustomPicture
        desktop={MapImg}
        mobile={MapImg}
        fallbackWidth={MapImg.width}
        fallbackHeight={MapImg.height}
        alt=""
        priority={false}
        class="map__picture"
      />
      <button>View Interactive Map</button>
    </div>
  </div>

  <!-- Spacer -->

  <div class="location__details">
    <address>73 Little Collins Street, Melbourne, 3000</address>
    <p>
      <a href="tel:+61039117599" class="telephone">+61 (03) 9111 7599</a>
    </p>
    <div>
      <p>
        <span>Breakfast:</span>
        <span>Monday to Friday 7:00 am - 11:15 am</span>
      </p>
      <p>
        <span>Lunch:</span>
        <span>Monday to Friday 12:00 pm - 4:00 pm</span>
      </p>
      <p>
        <span>Happy Hour:</span>
        <span>Tuesday to Saturday - 4:00pm to 6:00pm</span>
      </p>
      <p>
        <span>Dinner:</span>
        <span>Tuesday to Saturday 4:00 pm - Late</span>
      </p>
    </div>
  </div>
</section>

<style>
  .location {
    margin-block-end: 40px;
  }

  .map__wrapper {
    position: relative;
    border-radius: 20px;
  }

  .map-facade {
    position: relative;
    display: grid;
    place-items: center;

    max-width: 100%;
    width: 100%;
    border-radius: 20px;

    button {
      position: absolute;
      padding: 8px 16px;
      border: none;
      border-radius: 20px;
      background-color: hsl(0 0% 0% / 0.7);
      color: var(--clr-neutral-0);
      font-weight: var(--fw-700);
      font-size: var(--fs-600);
      cursor: pointer;
    }

    .map__picture {
      position: relative;

      :after {
        content: "";
        position: absolute;
        inset: 0;
        background-color: hsl(0 0% 0% / 0.1);
      }
    }
  }

  .location__details {
    display: grid;
    gap: 20px;
    margin-block-start: 30px;
    text-align: center;
    font-family: var(--ff-secondary);
    font-size: var(--fs-300);
  }

  .telephone {
    color: var(--clr-neutral-900);
  }

  @media (min-width: 40rem) {
    .location {
      padding-inline: 10px;
    }

    .map__wrapper {
      grid-column: 2 / 9;
    }

    .location__details {
      grid-column: 10 / -2;
      align-content: center;
      margin-block-start: 0px;
      margin-inline-start: 20px;
      text-align: left;
    }
  }
</style>

<script>
  const mapFacade = document.querySelector<HTMLElement>(".map-facade");
  const button = mapFacade!.querySelector("button");
  console.log(mapFacade);

  if (mapFacade && button) {
    button.addEventListener("click", () => {
      const iframe = document.createElement("iframe");
      iframe.src = mapFacade.dataset.mapSrc ?? "";
      iframe.width = `600`;
      iframe.height = `450`;
      iframe.loading = "lazy";
      iframe.referrerPolicy = "no-referrer-when-downgrade";
      iframe.allowFullscreen = true;
      iframe.style.border = "0";
      iframe.classList.add(`map`);

      mapFacade.replaceWith(iframe);
    });
  }
</script>
